##  クエリインターフェイス
- 概要
  - データベースに問い合わせる際の窓口のこと

##  DBからオブジェクトを取得する
- 単一のオブジェクトを取り出す
  - find
    - 主キーに対応するオブジェクトを取り出す
  - take
    - レコードを１件取り出す
  - first
    - 主キー順の最初のレコードを取り出す
  - last
    - 主キー順の最後のレコードを取り出す
  - find_by
    - 条件に合致するレコードの中で最初の１件を取り出す
- （後で）複数のオブジェクトをバッチで取り出す


##  (後で)条件


##  並び替え
- DBから取り出すレコードを特定の順序で並び替える
  - order
    - Book.order(created_at: :desc)
    - ASC(昇順)やDESC(降順)も指定できる
    - 複数のフィールドを指定して並べることもできる

##  特定のフィールドだけを取り出す
- 結果セットから特定のフィールドだけを取り出す
  - select
    - Book.select(:isbn, :out_of_print)
- 重複のない一意の値を１レコードだけ取り出す
  - distinct
    - Book.select(:last_name).distinct

##  LimitとOffset
- 取り出すレコードの数を制限する
  - limit
    - 最初の５件を取り出す
    - Book.limit(5)
  - offset
    - 最初の30件をスキップして、31件から５件を取り出す
    - Book.limit(5).offset(30)

##  グループ
- レコードをグループ化する
  - group
    - 注文(order)の作成日のコレクションを検索したい
    - Order.select("created_at").group("created_at")
- グループ化された項目の数をカウントする
  - count
    - Order.group(:status).count

##  Having条件
- グループ化されたレコードに対して条件を指定する
  - having
    - priceが1000円以上の商品のみを取り出す
    - Order.select("created_at, sum(total) as total_price").
  group("created_at").having("sum(total) > ?", 1000)

##  条件を上書きする
- 特定の条件を取り除ける
  - unscope
    - Book.where('id > 100').order('id desc').unscope(:order)
- 条件を上書きする
  - only
    - Book.where('id > 100').order('id desc').only(:where)
- 既存のselect文を上書きする
  - reselect
    - Book.select(:isbn).reselect(:title)
- スコープの並び順を上書きする
  - reorder
    - Author.find(10).books.reorder('year_published ASC')
- 並び順を逆にする
  - reverse_order
    - Book.where("author_id > 10").reverse_order
- 既存のwhere条件を上書きする
  - rewhere
    - Book.where("author_id > 10").rewhere("author_id < 20")
- 既存の名前付きgroup条件をオーバーライドする
  - regroup
    - Book.group(:author_id).regroup("title")
##  (後で)Nullリレーション


##  読み取り専用オブジェクト
- 返されたどのオブジェクトにも変更を明示的に禁止する
  - readonly
    - visitsの値を更新して、customer.saveを行うと例外が発生する
    ```rb
    customer = Customer.readonly.first
    customer.visits += 1
    customer.save # ActiveRecord::ReadOnlyRecordがraiseされる
    ```

##  レコードを更新できないようロックする
- 排他制御とは